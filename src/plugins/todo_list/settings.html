<div class="form-group">
  <div class="form-group nowrap">
    <label for="title" class="form-label">Title:</label>
    <input type="text" id="title" name="title" placeholder="To-Do" class="form-input" />
  </div>

{% for i in [1,2,3,4,5] %}
<div class="form-group nowrap" style="align-items:center; gap:1rem;">
  <label for="item{{i}}" class="form-label">Item {{i}}:</label>
  <input type="text" id="item{{i}}" name="item{{i}}" class="form-input" placeholder="Task {{i}}" style="flex:1;" />

  <label style="display:flex; align-items:center; gap:.4rem; margin-left:.5rem;">
    <input type="checkbox" id="done{{i}}" name="done{{i}}" value="true">
    Completed
  </label>
  <!-- Always send a value; unchecked -> only this false survives -->
  <input type="hidden" name="done{{i}}" value="false">
</div>
{% endfor %}
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const ps = window.pluginSettings || {};
    document.getElementById('title').value = ps.title || '';
    const truthy = v => ['1','true','on','yes','checked'].includes(String(v).toLowerCase());
    for (let i = 1; i <= 5; i++) {
      const it = document.getElementById('item' + i);
      const dn = document.getElementById('done' + i);
      if (it) it.value = ps['item' + i] || '';
      if (dn) dn.checked = truthy(ps['done' + i]);
    }
  });
</script>